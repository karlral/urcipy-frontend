<p-toast></p-toast>

<p-table #dt [value]="corredores" [rows]="10" [paginator]="true" [globalFilterFields]="['nombre']"
    [tableStyle]="{'min-width': '50rem'}" [rowHover]="true" dataKey="idcorredor"
    currentPageReportTemplate="Mostrar {first} a {last} de {totalRecords} totales" [showCurrentPageReport]="true">

    <ng-template pTemplate="caption">
        <div class="flex align-items-center justify-content-between">
            <button pButton pRipple icon="pi pi-plus" class="p-button-success mr-2" (click)="openNew()"></button>
            <h2 class="m-0">Corredores</h2>
            <span class="p-input-icon-left">
                <i class="pi pi-search"></i>
                <input pInputText type="text" (input)="dt.filterGlobal($any($event.target).value, 'contains')"
                    placeholder="Buscar..." />
            </span>
        </div>
    </ng-template>

    <ng-template pTemplate="header">
        <tr>
            <th>Cod.</th>
            <th pSortableColumn="nombre" style="min-width:15rem">Nombre <p-sortIcon field="nombre"></p-sortIcon></th>
            <th>Club</th>
            <th></th>
        </tr>
    </ng-template>
    <ng-template pTemplate="body" let-corredor>
        <tr>
            <td>{{corredor.idcorredor}}</td>
            <td>{{corredor.nombre}}</td>
            <td>{{corredor.club.nomclub}}</td>
            
            <td>
                <button pButton pRipple icon="pi pi-pencil" class="p-button-rounded p-button-success mr-2"
                    (click)="editCorredor(corredor)"></button>
                <button pButton pRipple icon="pi pi-trash" class="p-button-rounded p-button-warning"
                    (click)="deleteCorredor(corredor)"></button>
            </td>
        </tr>
    </ng-template>
</p-table>

<!-- agregar nuevo-->
<p-dialog [(visible)]="corredorDialog" header="Corredor" [modal]="true">
    <ng-template pTemplate="content">
        <div class="contenedor flex flex-row flex-wrap justify-content-between">
            <div class="field">
                <label for="nombre">Nombre</label>
                <input type="text" pInputText id="nombre" [(ngModel)]="corredor.nombre" required autofocus
                    placeholder="Nombre" />
                <small class="p-error" *ngIf="submitted && !corredor.nombre">Nombre de corredor es requerido.</small>
            </div>
            <div class="field">
                <label for="apellido">Apellidos</label>

                <input type="text" pInputText id="apellido" [(ngModel)]="corredor.apellido" required
                    placeholder="Apellido" />
                <small class="p-error" *ngIf="submitted && !corredor.apellido">Apellido de corredor es
                    requerido.</small>
            </div>

            <div class="field">
                <label for="ci">CIP</label>

                <input type="text" pInputText id="ci" [(ngModel)]="corredor.ci" required placeholder="CI" />
                <small class="p-error" *ngIf="submitted && !corredor.ci">CI de corredor es requerido.</small>
            </div>
            <div class="field">
                <label for="telefono">Telefono</label>
                <input type="text" pInputText id="telefono" [(ngModel)]="corredor.telefono" required
                    placeholder="Telefono" />
                <small class="p-error" *ngIf="submitted && !corredor.telefono">Nombre de corredor es requerido.</small>
            </div>
            
            <div class="field">
                <label for="email">Email</label>

                <input type="text" pInputText id="email" [(ngModel)]="corredor.email" placeholder="Email" />
            </div>

            <div class="field">
                <label for="nombre">Ciudad</label>

                <p-dropdown [options]="ciudades" [(ngModel)]="corredor.ciudad" placeholder="Seleccionar una ciudad"
                    autoWidth="false" [style]="{'width':'100%'}" optionLabel="nomciudad" [showClear]="true"
                    appendTo="body"></p-dropdown>

            </div>
            <div class="field">
                <label for="email">Nacionalidad</label>
                
                <p-dropdown [options]="paises" [(ngModel)]="corredor.nacionalidad" autoWidth="false"
                    [style]="{'width':'100%'}" placeholder="Seleccionar la nacionalidad" optionLabel="nacionalidad"
                    optionValue="nacionalidad" [showClear]="true" appendTo="body"></p-dropdown>
            </div>

            <div class="field">
               
                <label for="fecnac">Fecha Nacimiento</label>
                <p-calendar [(ngModel)]="corredor.fecnac" id="fecnac" appendTo="body" autoWidth="false"
                    [style]="{'width':'100%'}" dateFormat="dd/mm/yy"></p-calendar>
                <small class="p-error" *ngIf="submitted && !corredor.fecnac">Nombre de corredor es requerido.</small>
            </div>
            <div class="field">
                <label for="tipos">Tipo de Categoria</label>
                <p-dropdown [options]="tipos" [(ngModel)]="corredor.tipocat" id="tipo"
                    placeholder="Seleccionar tipo de categoria" autoWidth="false" [style]="{'width':'100%'}"
                    optionLabel="label" optionValue="value" [showClear]="true" appendTo="body"></p-dropdown>
            </div>
            

            <div class="field">
                <label for="nombre">Categoria</label>

                <p-dropdown [options]="categorias" [(ngModel)]="corredor.categoria" autoWidth="false"
                    [style]="{'width':'100%'}"  placeholder="Seleccionar una categoria" optionLabel="nomcorto"
                    [showClear]="true" appendTo="body" [disabled]="true"></p-dropdown>

            </div>

            

            <div class="field">
                <label for="nombre">Club</label>

                <p-dropdown [options]="clubes" [(ngModel)]="corredor.club" placeholder="Seleccionar un club"
                    autoWidth="false" [style]="{'width':'100%'}" optionLabel="nomclub" [showClear]="true"
                    appendTo="body"></p-dropdown>

            </div>

            <div class="field ">
                <label class="mb-3" for="nombre">Grupo Sanguineo</label>
              

                <p-dropdown [options]="grupos" [(ngModel)]="corredor.gruposanguineo" id="gruposanguineo"
                    autoWidth="false" [style]="{'width':'100%'}" placeholder="Seleccionar grupo"
                    optionLabel="label" optionValue="value" [showClear]="true" appendTo="body"></p-dropdown>
            </div>

            <div class="field">
            
                <label class="mb-3">Sexo</label>
                <div class="flex justify-content-around flex-wrap">
                    <div class="field-radiobutton">
                        <p-radioButton id="sexo1" name="sexo" value="1" [(ngModel)]="corredor.sexo"></p-radioButton>
                        <label for="sexo1">Masculino</label>
                    </div>
                    <div class="field-radiobutton">
                        <p-radioButton id="sexo2" name="sexo" value="0" [(ngModel)]="corredor.sexo"></p-radioButton>
                        <label for="sexo2">Femenino</label>
                    </div>
                </div>


            </div>
            <div class="field flex align-items-center justify-content-evenly flex-wrap">
                <label for="licencia">Licencia</label>
                <p-inputNumber inputId="licencia" [(ngModel)]="corredor.licencia" inputStyleClass="text-right">
                </p-inputNumber>
            </div>

            
            <div class="field flex align-items-center justify-content-evenly flex-wrap">
                <label for="carnetfpc" class="mr-2">Carnet FPC</label>
                <p-inputSwitch id="carnetfpc" [(ngModel)]="corredor.carnetfpc"></p-inputSwitch>
            </div>

<div class="field flex align-items-center justify-content-evenly flex-wrap">
                <label for="modificar" class="mr-2">Modificar</label>
                <p-inputSwitch id="modificar" [(ngModel)]="corredor.modificar"></p-inputSwitch>
            </div>
            <div class="field flex align-items-center justify-content-evenly flex-wrap">
                <label for="puntua" class="mr-2">Puntua</label>
                <p-inputSwitch id="puntua" [(ngModel)]="corredor.puntua"></p-inputSwitch>
            </div>



            <div class="field">
                <label for="observacion">Observacion</label>
                <textarea rows="5" cols="40" pInputTextarea [(ngModel)]="corredor.observacion"></textarea>

            </div>
            
            <div class="field">
                <label for="nombre">Tutor</label>

                <input type="text" pInputText id="tutorp" [(ngModel)]="corredor.tutorp" required placeholder="Tutor" />
                <small class="p-error" *ngIf="submitted && !corredor.tutorp">Nombre de corredor es requerido.</small>
            </div>
            
            <div class="field">
                <label for="citp">CI tutor</label>
                <input type="text" pInputText id="citp" [(ngModel)]="corredor.citp" placeholder="CI tutor" />

                <small class="p-error" *ngIf="submitted && !corredor.citp">Nombre de corredor es requerido.</small>
            </div>
            <div class="field">
                <label for="direccion">Direccion</label>

                <input type="text" pInputText id="direccion" [(ngModel)]="corredor.direccion" placeholder="Direccion" />

            </div>
            
            
            <div class="field">
                <label class="mb-3">Verificacion Datos</label>
                <div class="flex justify-content-around flex-wrap">
                    <div class="field-radiobutton">
                        <p-radioButton id="verificar1" name="verificar" value="1"
                            [(ngModel)]="corredor.verificar"></p-radioButton>
                        <label for="verificar1">Si</label>
                    </div>
                    <div class="field-radiobutton">
                        <p-radioButton id="verificar2" name="verificar" value="0"
                            [(ngModel)]="corredor.verificar"></p-radioButton>
                        <label for="verificar2">No</label>
                    </div>
                </div>
            </div>

            <div class="field">
                <img [src]="corredor.foto =='' ? '/assets/noimagen.png' : mediaLocation+corredor.foto"
                    [alt]="corredor.foto" class="regional-image" *ngIf="corredor.foto">
                <img [src]="preview" class="regional-image" *ngIf="preview">

            </div>

            <div class="field">
                <label for="foto" class="form-label">Seleccionar foto</label>
                <input id="foto" name="foto" class="form-control" accept="image/gif, image/jpeg, image/png" type="file"
                    (change)="selectFile($event)">
                {{fileName}}
            </div>
            <div class="field">
                <label  class="form-label">Modificado: {{corredor.fecmodi}}</label>
                <label  class="form-label">Usuario: {{corredor.usuario.username}}</label>
            </div>

        </div>

    </ng-template>

    <ng-template pTemplate="footer">
        <button pButton pRipple label="Cancel" icon="pi pi-times" class="p-button-text" (click)="hideDialog()"></button>
        <button pButton pRipple label="Save" icon="pi pi-check" class="p-button-text" (click)="saveCorredor()"></button>
    </ng-template>
</p-dialog>

<p-confirmDialog [style]="{width: '450px'}"></p-confirmDialog>